# 경기도 카드 소비 데이터 분석 가이드

## 📌 데이터 특성 정리

### 기본 정보
- **시간 범위**: 2022년 1월 ~ 2025년 9월 (46개월)
- **데이터 크기**: 월별 약 1만 건 → 총 약 46만 행
- **시간 단위**: 요일 기준 일별 집계 데이터
- **가장 중요한 특징**: **전수화 보정 적용** (표본 카드 데이터를 모집단 규모로 추정)

### 코드 체계 이해
```
시군구코드: 5자리 (예: 41650 = 경기도 포천시)
행정동코드: 8자리 (예: 41650520 = 경기도 포천시 선단동)
업종분류코드: 영문+숫자 (예: F09 = 생활서비스-연료판매)
```

### 데이터 값의 의미
- **기준년월일**: 카드 매출이 발생한 구체적인 일자
- **매출금액/건수**: 해당 날짜의 카드 거래 합계 (요일 단위 집계)
- **전수화 보정**: 표본 카드 데이터를 실제 시장 규모로 추정한 값 → 신뢰도 높음

---

## 🎯 분석 프레임워크: 4개 주요 축

### 축1. 시간 트렌드 분석
**단위**: 월, 분기, 연도

**핵심 질문**:
- 전체 카드 소비는 시간에 따라 어떻게 변했는가?
- 코로나 이후, 금리 인상 이후 구체적 변화는?
- 계절성(월별 편차)이 있는가?

**외부 데이터 활용**:
- 금리 추이 (한국은행)
- 실업률 (통계청)
- 소비자신뢰지수 (기획재정부)
- 경제 이벤트 타임라인

**기대 인사이트**: 거시경제 지표와의 연동성, 구조적 변화 시점

---

### 축2. 업종 트렌드 분석
**단위**: 업종대분류, 업종중분류

**핵심 질문**:
- 어떤 업종이 성장/감소하는가?
- 업종별 성장 패턴이 동일한가 (또는 다른가)?
- 코로나 영향에 따라 업종별 회복이 다른가?

**외부 데이터 활용**:
- 각 업종 산업 통계
- 관광·문화·여가 정책
- 주요 사건(오픈/폐점 뉴스)

**기대 인사이트**: 승자 업종 vs 패자 업종, 구조적 트렌드 전환

---

### 축3. 인구통계학적 소비 패턴
**단위**: 성별, 연령별 (× 요일, 시간대, 업종)

**핵심 질문**:
- 세대별·성별로 업종 선호가 다른가?
- 야간/주말 소비자와 평일/주간 소비자의 구성은?
- 라이프스타일 변화(재택근무, 여행 증가)가 드러나는가?

**외부 데이터 활용**:
- 인구 피라미드 변화
- 고용 형태 (재택근무 비중)
- 혼인/출생/육아 정책

**기대 인사이트**: 세대별 소비 특성, 사회 구조 변화의 반영

---

### 축4. 공간(지역) 분석
**단위**: 시군구, 행정동

**핵심 질문**:
- 지역별 소비 규모와 구조가 다른가?
- 성장하는 지역 vs 정체/감소 지역은?
- 도시화/개발과 소비 패턴의 관계는?

**외부 데이터 활용**:
- 지역 인구 변화 (행안부)
- 사업체 통계 (통계청)
- 상권 개발/정책 (국토부)
- 대중교통 접근성

**기대 인사이트**: 지역 경제 활력도, 상권 발달 양극화

---

## 📊 Python 분석 5단계 로드맵

### Phase 1: 데이터 통합 및 전처리
```python
# 월별 파일 병합
df = pd.concat([pd.read_csv(file) for file in file_list], ignore_index=True)

# 필수 변환
df["기준년월일"] = pd.to_datetime(df["기준년월일"], format="%Y%m%d")
df["연도"] = df["기준년월일"].dt.year
df["월"] = df["기준년월일"].dt.month
df["연월"] = df["기준년월일"].dt.to_period("M")

# 파생 변수
def map_time_band(h):
    if 0 <= h < 6: return "심야(0-5시)"
    elif 6 <= h < 12: return "아침(6-11시)"
    elif 12 <= h < 18: return "오후(12-17시)"
    else: return "저녁(18-23시)"

df["시간대대역"] = df["시간대"].apply(map_time_band)
df["주말여부"] = df["요일번호"].isin([5, 6]).map({True: "주말", False: "평일"})
```

**결과물**: `통합_정제_데이터.parquet` (또는 CSV)

---

### Phase 2: 기초 EDA 및 시각화
```python
# 월별 전체 소비 추이
monthly = df.groupby("연월").agg({"매출금액": "sum"}).reset_index()
plt.plot(monthly.index, monthly["매출금액"])
plt.title("경기도 카드 매출 월별 추이")

# 업종별 구성
sector_monthly = df.groupby(["연월", "카드사_업종대분류명"])["매출금액"].sum()

# 요일-시간대 히트맵
dow_time = df.groupby(["요일명", "시간대대역"])["매출금액"].sum()
pivot = dow_time.unstack()
sns.heatmap(pivot)

# 지역별 순위 (Top 10)
region = df.groupby("시군구명")["매출금액"].sum().nlargest(10)
```

**결과물**: 기초 시각화 이미지 및 통계표

---

### Phase 3: 심화 분석 - 각 축별 상세 분석

#### 3-1. 시간축 심화
```python
# 성장률 계산
monthly_sales["월간성장률"] = monthly_sales["매출금액"].pct_change() * 100
monthly_sales["연간성장률"] = monthly_sales["매출금액"].pct_change(12) * 100

# 계절성 분해
seasonal_index = (df.groupby("월")["매출금액"].mean() / 
                  df["매출금액"].mean()) * 100
```

#### 3-2. 업종축 심화
```python
# 업종별 누적 성장률
sector_annual = df.groupby(["연도", "카드사_업종대분류명"])["매출금액"].sum()
# 전체 기간 비교로 승자/패자 분류

# 업종 비중 변화 추적
sector_share = df.groupby(["연도", "카드사_업종대분류명"])["매출금액"].sum()
```

#### 3-3. 인구통계축 심화
```python
# 성별×연령별×업종 교차 분석
demo_sector = df.groupby(["성별", "연령별", "카드사_업종대분류명"])["매출금액"].sum()

# 각 그룹별 상위 업종 추출
top_sectors_by_demo = demo_sector.groupby(["성별", "연령별"]).head(3)

# 야간 소비 비중 분석
night_ratio = df[df["시간대대역"] == "저녁(18-23시)"].groupby(["성별", "연령별"])["매출금액"].sum()
```

#### 3-4. 공간축 심화
```python
# 지역별 성장률
region_annual = df.groupby(["연도", "시군구명"])["매출금액"].sum()
region_growth = region_annual.pivot(columns="연도", values="매출금액").pct_change(axis=1)

# 업종 다양성 지수 (HHI)
# HHI = Σ(비중²) → 낮을수록 균형, 높을수록 편중
region_sector_share = df.groupby(["시군구명", "카드사_업종대분류명"])["매출금액"].sum()
region_hhi = (region_sector_share ** 2).groupby("시군구명").sum()
```

**결과물**: 심화 분석 리포트 (Markdown 또는 PDF)

---

### Phase 4: 외부 데이터 매칭 및 해석

#### 거시경제 지표 수집
| 지표 | 출처 | 월별 | 용도 |
|------|------|------|------|
| 기준금리 | 한국은행 경제통계 | ✓ | 소비 심리, 구매력 |
| 실업률 | 통계청 | ✓ | 가처분소득, 소비 능력 |
| 소비자신뢰지수 | 기획재정부 | ✓ | 구매 의욕 반영 |
| 물가지수(CPI) | 통계청 | ✓ | 실질 소비 증가 확인 |

#### Python 상관분석
```python
# 거시경제 데이터 통합
analysis_df = monthly_sales.merge(macro_data, on="연월", how="left")

# 상관관계 분석
correlation_matrix = analysis_df[["매출금액", "기준금리", "실업률"]].corr()

# 시차 고려 (Lag)
analysis_df["기준금리_lag1"] = analysis_df["기준금리"].shift(1)
# 금리 변화의 효과가 1개월 후에 나타나는지 확인

# 다중회귀
from sklearn.linear_model import LinearRegression
model = LinearRegression()
X = analysis_df[["기준금리", "실업률", "소비자신뢰지수", "월_더미"]]
model.fit(X, analysis_df["매출금액"])
```

#### 지역 데이터 정규화
```python
# 인구 정규화 (행안부 주민등록 인구)
region_sales = region_sales.merge(pop_data, on="행정동코드", how="left")
region_sales["인구만명당매출"] = (region_sales["매출금액"] / region_sales["인구"]) * 10000
# 인구당 매출이 높은 지역 = 실제 소비력 높은 지역

# 사업체 정규화 (통계청 사업체기초통계)
region_sales["업체당매출"] = region_sales["매출금액"] / region_sales["총업체수"]
# 업체당 매출 = 상권 수익성, 활력도
```

**결과물**: 외부 데이터 통합 분석 노트북

---

### Phase 5: 결론 및 액션 아이템

최종 리포트 구성:
1. **Executive Summary** (1page)
   - 핵심 발견사항 3~5가지
   - 주요 수치 요약

2. **4개 축별 인사이트** (각 2~3page)
   - 시간 트렌드: 언제 소비가 증가/감소했는가?
   - 업종 변화: 어떤 업종이 성장했는가?
   - 인구 특성: 누가 주로 소비하는가?
   - 지역 분석: 어디서 소비가 집중되는가?

3. **외부 요인 분석** (1~2page)
   - 거시경제 지표와의 연동성
   - 정책/이벤트의 영향

4. **정책/사업 인사이트** (1page)
   - 성장하는 지역/업종 지원 방향
   - 취약 지역/업종 활성화 방안
   - 타깃 마케팅 전략

5. **향후 전망** (1/2page)
   - 단순 시나리오 (낙관/중립/비관)

---

## 🔗 외부 데이터 보강 체크리스트

### 거시경제 데이터
- [ ] 기준금리 (한국은행 ECOS)
- [ ] 실업률 (통계청)
- [ ] 소비자신뢰지수 (기획재정부)
- [ ] 물가지수 전체/업종별 (통계청 CPI)
- [ ] GDP 성장률 (통계청)

### 지역 데이터
- [ ] 시군구별 월별 인구 (행안부)
- [ ] 행정동별 인구 (행안부)
- [ ] 업종별 사업체 수 (통계청 경제총조사)
- [ ] 상권 정보 (국토부 상권통계)
- [ ] 신규 지하철/역 개통 시점

### 산업/정책 데이터
- [ ] 주요 쇼핑몰/시설 오픈/폐점 타임라인
- [ ] 지역 축제/이벤트 일정
- [ ] 정부 소비 지원 정책 (예: 상품권 지급)
- [ ] 업종별 산업 리포트
- [ ] 날씨 데이터 (월별 기온, 강수량)

---

## 💡 분석 시 주의사항

1. **전수화 보정의 의미 이해**
   - 이 데이터는 표본 카드 거래를 확대 추정한 값
   - 절대 규모 자체보다 **트렌드와 구조 변화**에 집중

2. **카드 결제 비중 고려**
   - 카드 데이터는 카드 결제만 포함 (현금, 간편결제 제외)
   - 필요하면 "카드결제 비중" 정보 확보

3. **계절성 인식**
   - 12월, 설날 등 특정 시기 편차 존재
   - 전년동월 비교(YoY)로 정정

4. **인구 vs 소비 분석**
   - 같은 규모 소비라도 인구가 적은 지역이 소비력 높음
   - 정규화 지표(인구당, 사업체당) 반드시 포함

5. **인과관계 주의**
   - 상관관계 ≠ 인과관계
   - 외부 요인과 매출의 연동은 참고만 하고, 명확한 인과는 조심

---

## 📁 프로젝트 폴더 구조 추천

```
경기도카드소비데이터분석/
├── 01_raw_data/              # 원본 데이터 (월별 CSV)
│   ├── 202201.csv
│   ├── 202202.csv
│   └── ...
│
├── 02_processed_data/        # 정제된 데이터
│   └── 통합_정제_데이터.parquet
│
├── 03_external_data/         # 외부 데이터
│   ├── 거시경제지표.csv
│   ├── 지역인구.csv
│   ├── 사업체통계.csv
│   └── 상권정보.csv
│
├── 04_notebooks/             # 분석 노트북
│   ├── 01_EDA.ipynb
│   ├── 02_시간축분석.ipynb
│   ├── 03_업종축분석.ipynb
│   ├── 04_인구축분석.ipynb
│   ├── 05_공간축분석.ipynb
│   └── 06_외부데이터_통합.ipynb
│
├── 05_outputs/               # 분석 결과
│   ├── 차트/
│   ├── 통계표/
│   └── 리포트/
│
└── README.md                 # 프로젝트 설명
```

---

## 🎓 학습 리소스

1. **데이터 전처리**
   - Pandas 기초: `.groupby()`, `.merge()`, 날짜 처리
   - 파생 변수 생성

2. **통계 분석**
   - 시계열 분석 기초 (추세, 계절성)
   - 상관분석, 회귀분석
   - 가설검정 (t-test, ANOVA)

3. **시각화**
   - Matplotlib, Seaborn 기초
   - 히트맵, 라인 플롯, 바 플롯
   - 대화형 시각화 (Plotly)

4. **머신러닝 (선택)**
   - 군집분석 (KMeans, Hierarchical Clustering) → 지역 유형화
   - 시계열 예측 (ARIMA, Prophet) → 향후 추이 예측
   - 이상탐지 (Isolation Forest) → 비정상 소비 패턴 발견

---

마지막으로, 이 분석의 최종 목표는 **"왜?"라는 질문에 답하는 것**입니다.  
단순히 "2023년 매출이 2022년보다 10% 증가했다"는 사실보다,  
**"왜 증가했는가? (금리 인하? 정책 지원? 특정 업종 호황?)"** 를 파악하는 것입니다.

그 과정에서 외부 데이터와의 결합이 **해석력을 크게 높여줄 것**입니다.
